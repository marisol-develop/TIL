## ğŸ’¿ Core Data

> Core Data
Persist or cache data on a single device, or sync data to multiple devices with CloudKit.

Core DataëŠ” ë‹¨ì¼ ë””ë°”ì´ìŠ¤ì—ì„œ ë°ì´í„°ë¥¼ ì§€ì† ë˜ëŠ” ìºì‹±í•˜ê±°ë‚˜, CloudKitì„ ì‚¬ìš©í•´ì„œ ì—¬ëŸ¬ ë””ë°”ì´ìŠ¤ì— ë°ì´í„°ë¥¼ ë™ê¸°í™” í•˜ëŠ” `í”„ë ˆì„ ì›Œí¬` ë¼ê³  ì •ì˜ë˜ì–´ ìˆë‹¤

ì •ì˜ë¥¼ ì½ì–´ë³´ë©´ ë””ë°”ì´ìŠ¤ ë‚´ì— ë°ì´í„°ë¥¼ ì €ì¥í•´ë‘ê³ , CloudKitì´ë¼ëŠ”ê±¸ ì‚¬ìš©í•˜ë©´ ê°™ì€ iCloud ê³„ì •ì˜ ì—¬ëŸ¬ ë””ë°”ì´ìŠ¤ì—ì„œ ë°ì´í„°ë¥¼ ë™ê¸°í™” ì‹œí‚¬ ë•Œ Core Dataë¥¼ ì‚¬ìš©í•œë‹¤ëŠ” ëŠë‚Œì´ ë“ ë‹¤ ğŸ§

ê³µì‹ë¬¸ì„œì˜ Overviewë¥¼ ë³´ë©´ Core Dataì˜ ì“°ì„ì´ ë” ìì„¸í•˜ê²Œ ë‚˜ì™€ìˆë‹¤

> Core Dataë¥¼ ì‚¬ìš©í•´ì„œ ì˜¤í”„ë¼ì¸ì—ì„œì˜ ì‚¬ìš©ì„ ìœ„í•´ ì•±ì˜ ì˜êµ¬ ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³ , ì„ì‹œ ë°ì´í„°ë¥¼ ìºì‹±í•˜ê³ , ë””ë°”ì´ìŠ¤ì—ì„œ ì•±ì— ì‹¤í–‰ ì·¨ì†Œ ê¸°ëŠ¥ì„ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤
ë‹¨ì¼ iCloud ê³„ì •ì— ìˆëŠ” ì—¬ëŸ¬ ë””ë°”ì´ìŠ¤ì—ì„œ ë°ì´í„°ë¥¼ ë™ê¸°í™”í•˜ê¸° ìœ„í•´ Core DataëŠ” ìë™ìœ¼ë¡œ ìŠ¤í‚¤ë§ˆë¥¼ CloudKit ì»¨í…Œì´ë„ˆì— ë¯¸ëŸ¬ë§í•œë‹¤
Core Dataì˜ Data Model Editorë¥¼ í†µí•´ ë°ì´í„°ì˜ íƒ€ì…ê³¼ ê´€ê³„ (relationships) ì •ì˜í•˜ê³ , ê° class definitionsë¥¼ ìƒì„±í•œë‹¤
ê·¸ëŸ¬ë©´ Core DataëŠ” ëŸ°íƒ€ì„ì— managed object instanceë¥¼ ê´€ë¦¬í•˜ì—¬ ë‹¤ìŒì˜ ì—¬ëŸ¬ ê¸°ëŠ¥ì„ ì œê³µí•  ìˆ˜ ìˆë‹¤

ğŸ¤¯ ë””ë°”ì´ìŠ¤ ë‚´ì— ë°ì´í„°ë¥¼ ì €ì¥í•œë‹¤ëŠ” ê±´ ì•Œê² ëŠ”ë°..
Data Model Editor, relationships, class definitions, managed object instance ê°™ì€ ê°œë…ë“¤ì„ ê³µë¶€í•˜ê³  ìœ„ ê¸€ì„ ë‹¤ì‹œ ë´ì•¼ë  ê²ƒ ê°™ë‹¤

ê·¸ëŸ¼ Core Dataê°€ ì œê³µí•œë‹¤ëŠ” ì—¬ëŸ¬ ê¸°ëŠ¥ë“¤ì„ ì´ì–´ì„œ ë³´ë©´

### ğŸ“Œ Persistence (ì§€ì†)

Core DataëŠ” ê°ì²´ë¥¼ ì €ì¥ì†Œì— ë§¤í•‘í•˜ëŠ” ì„¸ë¶€ ì •ë³´ë“¤ì„ ì¶”ìƒí™” í•˜ê¸° ë•Œë¬¸ì—, ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì§ì ‘ ê´€ë¦¬í•˜ì§€ ì•Šê³ ë„ Swift ë° Objective-Cì—ì„œ ë°ì´í„°ë¥¼ ì‰½ê²Œ ì €ì¥í•  ìˆ˜ ìˆë‹¤
![](https://velog.velcdn.com/images/marisol/post/7e4258a3-70e4-4fbb-aaf2-d62e13797544/image.png)

ì € ê¹¡í†µê°™ì´ ìƒê¸´ê²Œ ì €ì¥ì†Œ(Store)ì´ê³ , Core Dataë¥¼ ì´ìš©í•´ì„œ ì €ì¥ì†Œì— ë°ì´í„°ë¥¼ ì˜êµ¬ì ìœ¼ë¡œ ì €ì¥í•˜ê³ , ë˜ ê°€ì ¸ì˜¬ ìˆ˜ ìˆëŠ” ê²ƒ ê°™ë‹¤

### ğŸ“Œ Undo and Redo of Individual or Batched Changes (ê°œë³„ ë˜ëŠ” ì¼ê´„ëœ ë³€ê²½ì˜ ì‹¤í–‰ ì·¨ì†Œ ë° ë‹¤ì‹œ ì‹¤í–‰)

Core Dataì˜ undo manager(ì‹¤í–‰ ì·¨ì†Œ ê´€ë¦¬ì)ëŠ” ë³€ê²½ ì‚¬í•­ì„ ì¶”ì í•˜ê³  ê°œë³„, ê·¸ë£¹, ë˜ëŠ” í•œë²ˆì— ëª¨ë‘ ë¡¤ë°±í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì•±ì— ì‹¤í–‰ ì·¨ì†Œ ë° ë‹¤ì‹œ ì‹¤í–‰ ì§€ì›ì„ ì‰½ê²Œ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤

![](https://velog.velcdn.com/images/marisol/post/35c8a875-f19b-4463-8c70-d4e0403efd66/image.png)

í…ìŠ¤íŠ¸ í¸ì§‘í•˜ë‹¤ê°€ í° í”ë“¤ë©´ ì‹¤í–‰ ì·¨ì†Œ ì–¼ëŸ¿ ëœ¨ëŠ” ê¸°ëŠ¥ì„ ë§í•˜ëŠ” ê²ƒ ê°™ë‹¤
ìœ„ì— ê·¸ë¦¼ì€ ì–´ë–¤ í•­ëª©ì„ ì‚­ì œí•˜ê³ ë‚˜ì„œ í”ë“¤ë©´ ì‹¤í–‰ì·¨ì†Œ ì²˜ë¦¬ë˜ì–´ì„œ ì‚­ì œí•œ í•­ëª©ì„ ë‹¤ì‹œ í‘œì‹œí•˜ëŠ” ê³¼ì •ì„ ë³´ì—¬ì£¼ê³  ìˆë‹¤

### ğŸ“Œ Background Data Tasks (ë°±ê·¸ë¼ìš´ë“œì—ì„œ ë°ì´í„° ì‘ì—…)

ë°±ê·¸ë¼ìš´ë“œ ìƒíƒœì—ì„œ JSONì„ ê°ì²´ë¡œ parsingí•˜ëŠ” ê²ƒê³¼ ê°™ì€ ì ì¬ì ì¸ UI-blocking ë°ì´í„° ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤
ê·¸ëŸ°ë‹¤ìŒ ê²°ê³¼ë¥¼ ìºì‹±í•˜ê±°ë‚˜ ì €ì¥í•˜ì—¬ ì„œë²„ ë¼ìš´ë“œ íŠ¸ë¦½ì„ ì¤„ì¼ ìˆ˜ ìˆë‹¤ (ì„œë²„ ë¼ìš´ë“œ íŠ¸ë¦½ì€ ë°ì´í„° ë¡œë”©ì„ ìœ„í•´ ì„œë²„ì— ê°”ë‹¤ ì˜¤ëŠ” íšŸìˆ˜ë¥¼ ë§í•˜ëŠ” ê²ƒ ê°™ë‹¤)![](https://velog.velcdn.com/images/marisol/post/8a6ab42b-f548-4dfc-bbd2-39991a6088aa/image.png)

ìœ„ì— ê·¸ë¦¼ì€ UI ì‘ì—… ì „ì— ë°±ê·¸ë¼ìš´ë“œì—ì„œ ë°ì´í„° ì‘ì—…ì„ í•˜ëŠ” ê²ƒ ê°™ë‹¤

### ğŸ“Œ View Synchronization (ë·° ë™ê¸°í™”)

Core DataëŠ” í…Œì´ë¸”ë·°ì™€ ì»¬ë ‰ì…˜ ë·°ì— ëŒ€í•œ data sourceë¥¼ ì œê³µí•´ì„œ ë·°ì™€ ë°ì´í„°ë¥¼ ë™ê¸°í™” ì‹œì¼œì¤€ë‹¤

### ğŸ“Œ Versioning and Migration (ë²„ì „ ê´€ë¦¬ ë° ë§ˆì´ê·¸ë ˆì´ì…˜)

Core Dataì—ëŠ” ë°ì´í„° ëª¨ë¸ì„ ë²„ì „í™” í•˜ê³ , ì•±ì˜ ë°œì „ì— ë”°ë¼ ì‚¬ìš©ì ë°ì´í„°ë¥¼ ë§ˆì´ê·¸ë ˆì´ì…˜í•˜ëŠ” ë©”ì»¤ë‹ˆì¦˜ì´ í¬í•¨ë˜ì–´ ìˆë‹¤

ì–´ë–¤ ì•±ì´ ì‹œê°„ì´ ì§€ë‚˜ë©´ì„œ ì²˜ìŒ Core Dataì˜ ë°ì´í„° ëª¨ë¸ì´ ë³€ê²½ë  ê²½ìš°, ì‚¬ìš©ì ë°ì´í„°ë¥¼ ë§ˆì´ê·¸ë ˆì´ì…˜ í•  ìˆ˜ ìˆë‹¤ëŠ” ë§ì¸ ê²ƒ ê°™ë‹¤

ì²˜ìŒì—ëŠ” Core DataëŠ” ë””ë°”ì´ìŠ¤ì— ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ”êµ¬ë‚˜ë¼ê³ ë§Œ ìƒê°í–ˆëŠ”ë° ë” ë‹¤ì–‘í•œ ê¸°ëŠ¥ì„ í•˜ëŠ” ê²ƒ ê°™ë‹¤

---
## ğŸ‘©ğŸ»â€ğŸ’» Core Data Model ìƒì„±

ì•±ì—ì„œ ìƒì„±í•œ ë°ì´í„°ë¥¼ Core Dataì— ì €ì¥í•˜ê¸° ìœ„í•´ í”„ë¡œì íŠ¸ì— Core Data Modelì„ ë§Œë“¤ì–´ë³¼ê±°ë‹¤

í”„ë¡œì íŠ¸ ìƒì„±í•  ë•Œ `Use Core Data`ë¥¼ ì²´í¬í•˜ê³  ìƒì„±í•˜ë©´ AppDelegate.swift íŒŒì¼ì— `Core Data Stack` ê´€ë ¨ ì½”ë“œë“¤ì´ ì¶”ê°€ëœë‹¤

![](https://velog.velcdn.com/images/marisol/post/aad51cd6-cbb0-45f6-af2b-ee984deb53d1/image.png)

ì¼ë‹¨ì€ DataModel.swift íŒŒì¼ì„ ìƒì„±í•˜ê³ , Entityë¥¼ ìƒì„±í•´ì¤€ë‹¤

EntityëŠ” ì €ì¥ë˜ê³  ê´€ë¦¬ë˜ì–´ì•¼ í•  ë°ì´í„°ì˜ ì§‘í•©ì„ ë§í•œë‹¤
ì¼ê¸°ì¥ í”„ë¡œì íŠ¸ë‹ˆê¹Œ ì´ë¦„ì€ DiaryModelë¡œ í•´ì¤¬ë‹¤

Attributeì—ëŠ” DiaryModelì´ë¼ëŠ” Entityì— ì €ì¥ë  ìš”ì†Œë“¤ì„ ì¶”ê°€í•´ì¤€ë‹¤![](https://velog.velcdn.com/images/marisol/post/9466ecf4-f746-4318-981d-f91b45d78baa/image.png)

ê·¸ë¦¬ê³ ë‚˜ì„œ ì˜¤ë¥¸ìª½ Ispectorë¥¼ ë³´ë©´ `Codegen`ì´ë¼ëŠ” í•­ëª©ì´ ìˆëŠ”ë°, `Class Definition`, `Category/Extension`, `Manual/None`ì´ ìˆë‹¤ ![](https://velog.velcdn.com/images/marisol/post/107bf1fc-796a-4c00-aa0e-28abaee0df3a/image.png)

Codegenì´ ì˜ë¯¸í•˜ëŠ”ê±´ Code Generation Optionì´ë‹¤ (ì½”ë“œ ìƒì„± ì˜µì…˜)

ìœ„ì—ì„œ ë§í•œ ì €ì¥ë˜ê³  ê´€ë¦¬ë˜ì–´ì•¼ í•  ë°ì´í„°ì˜ ì§‘í•©ì¸ Entityì—ì„œ managed object subclassesë¥¼ ìë™ ë˜ëŠ” ìˆ˜ë™ìœ¼ë¡œ ìƒì„±í•˜ëŠ”ë°, ê·¸ë•Œì˜ ì˜µì…˜ì„ ë§í•˜ëŠ” ê²ƒ ê°™ë‹¤

- `Class Definition`
    - Core Dataê°€ ìƒì„±í•˜ëŠ” `managed object subclasses`ì™€ `properties` íŒŒì¼ì˜ ì†ì„±ì´ë‚˜ ê¸°ëŠ¥ì„ ìˆ˜ì •í•  í•„ìš”ê°€ ì—†ëŠ” ê²½ìš° ì„ íƒ
    - managed object subclassesì™€ properties íŒŒì¼ ëª¨ë‘ ìë™ ìƒì„±
    - ìƒì„±ëœ ì†ŒìŠ¤ ì½”ë“œê°€ í”„ë¡œì íŠ¸ì˜ ëª©ë¡ì— ë‚˜íƒ€ë‚˜ì§€ ì•ŠëŠ”ë‹¤
    
- `Category/Extension`
    - Properties íŒŒì¼ë§Œ ìƒì„±
    - managed object subclass ë‚´ì— ë©”ì„œë“œë‚˜ ë¡œì§ì„ ì¶”ê°€í•˜ê¸° ìœ„í•´ ì‚¬ìš©
    
- `Manual/None`
    - ë‘ íŒŒì¼ ëª¨ë‘ ìˆ˜ë™ìœ¼ë¡œ ê´€ë¦¬
    - ì´ ì˜µì…˜ì„ ì„ íƒí•˜ë©´ managed object íŒŒì¼ì„ ìƒì„±í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì—, classì™€ propertiesë¥¼ ìˆ˜ë™ìœ¼ë¡œ ë§Œë“¤ê³  ê´€ë¦¬
    - ì²˜ìŒì— classì™€ properties íŒŒì¼ì„ ìƒì„±í•˜ë ¤ë©´ Xcode > Editor > Create NSManaged Object Subclass ì„ íƒ
    - í”„ë¡œì íŠ¸ ëª©ë¡ì—ì„œ class íŒŒì¼ê³¼ properties íŒŒì¼ì„ ëª¨ë‘ ë³´ê³  ìˆ˜ì • ê°€ëŠ¥

ë‚˜ëŠ” Manual/Noneì„ ì„ íƒí–ˆëŠ”ë°, ê·¸ëŸ¬ë©´ ì•„ë˜ ì‚¬ì§„ì²˜ëŸ¼ í”„ë¡œì íŠ¸ íŒŒì¼ì—ì„œ ë‘ ê°œì˜ íŒŒì¼ì„ ë³¼ ìˆ˜ ìˆê³ , ìˆ˜ì •ë„ í•  ìˆ˜ ìˆë‹¤
![](https://velog.velcdn.com/images/marisol/post/f0efc5a1-c717-4aa5-932e-d5418b273f0a/image.png)

ê·¸ëŸ¬ë©´ ì´ì œ DiaryModelê³¼ ê·¸ Entityì— í¬í•¨ëœ Attributesë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ëœë‹¤

CoreData Modelì€ ìƒì„±í–ˆê³ , ê·¸ëŸ¼ ì´ì œ ì•±ì—ì„œ ë°ì´í„°ë¥¼ Core Dataì— ì €ì¥í•˜ê³ , ë¶ˆëŸ¬ì˜¤ê¸°ë§Œ í•˜ë©´ ëœë‹¤
ï¹¢ Core Data Stackê¹Œì§€ ë‹¤ìŒ TILì—ì„œ,,ğŸ‘‹

---

ì°¸ê³ ìë£Œ
- https://developer.apple.com/documentation/coredata
- https://developer.apple.com/documentation/coredata/creating_a_core_data_model
- https://developer.apple.com/documentation/coredata/modeling_data/generating_code
- https://zeddios.tistory.com/987
- https://icksw.tistory.com/224
