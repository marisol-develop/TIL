# TIL(2022.05.02)

> date: 2022.05.02</br>
> 진행중인 프로젝트: ios-bank-manager
> 활동학습 주제: HTTP, TCP/IP

## 👩🏻‍💻학습내용
## 📝 HTTP
- HTTP(Hyper Text Transfer Protocol): HTML 문서 같은 리소스들을 주고받는 프로토콜이다. 웹에서 이루어지는 모든 데이터 교환의 기초이다
- 클라이언트와 서버 사이에 이루어지는 요청/응답(request/response) 프로토콜이다
    - 클라이언트와 서버는 개별적인 메시지 교환에 의해 통신하는데, 클라이언트에 의해 전송되는 메시지를 요청이라고 하며, 그에 대해 서버에서 응답으로 전송되는 메시지를 응답이라고 부른다
    - 예를 들면 클라이언트인 웹브라우저가 HTTP를 통하여 서버로부터 웹페이지(HTML)나 그림정보를 요청하면, 서버는 이 요청에 응답하여 필요한 정보를 해당 사용자에게 전달하게 된다. 이 정보가 모니터와 같은 출력 장치를 통해 사용자에게 나타나는 것이다

### 1. HTTP 기반 시스템의 구성요소

1. 클라이언트 (사용자 에이전트)
- 사용자 에이전트: 사용자를 대신하여 동작하는 모든 도구이며, 이 역할은 주로 브라우저에 의해 수행됨
- 항상 요청을 보내는 개체

2. 웹 서버
- 클라이언트에 의한 요청에 대한 문서를 제공

3. 프록시
- 웹 브라우저와 서버 사이에는 수많은 컴퓨터와 머신이 HTTP 메시지를 이어 받고 전달한다. 이런 컴퓨터/머신 중에서도 애플리케이션 계층에서 동작하는 것들을 프록시라고 함
- 서버와 클라이언트 사이에 중계기로서 대리로 통신을 수행하는 것
- 프록시의 기능
    - 캐싱 (프록시 서버에 요청된 내용들을 캐시를 이용해 저장해두면 캐시 안에 있는 정보를 요구하는 요청에 대해서는 원격 서버에 접속해서 데이터를 가져올 필요 없음)
    - 필터링 (바이러스 백신 스캔, 유해 컨텐츠 차단)
    - 로드 밸런싱 (여러 서버들이 서로 다른 요청을 처리하도록 허용)
    - 인증 (다양한 리소스에 대한 접근 제어)
    - 로깅 (이력 정보를 저장)

### 2. HTTP 요청 메서드

- CONNECT: 요청한 리소스에 대해 양방향 연결을 시작하는 메서드
    - 문법: CONNECT www.example.com:443 HTTP/1.1
- DELETE: 지정한 리소스를 삭제하는 메서드
    - 문법: DELETE /file.html HTTP/1.1
- GET: 특정한 리소스를 가져오도록 요청하는 메서드
    - 문법: GET / index.html
- HEAD: 특정 리소스를 GET 메서드로 요청했을 때 돌아올 헤더를 요청하는 메서드
    - 문법: HEAD /index.html
- OPTIONS: 목표 리소스와의 통신 옵션을 설명하기 위해 사용되는 메서드
    - 문법: OPTIONS /index.html HTTP/1.1
- PATCH: 리소스를 부분적으로 수정할 때 사용하는 메서드
    - PUT 메서드는 리소스를 완전히 교체한다는 점에서 다르고, PATCH는 멱등성을 갖지 않는다. 하지만 PATCH를 PUT과 같은 방식으로 사용하면 멱등성을 갖게할 수도 있다
        - PUT과 같은 방식: 변경할 부분 외에도 전부 다 같이 보내서 변경하는 것
    - 문법: PATCH /file.txt HTP/1.1
- POST: 서버로 데이터 전송하는 메서드
    - POST 요청은 보통 HTML 양식을 통해 서버에 전송하며, 서버에 변경사항을 만듦
    - 문법: POST /index.html
- PUT: 요청 페이로드를 통해 새로운 리소스를 생성하거나, 대상 리소스를 나타내는 데이터를 대체하는 메서드
    - 대상 리소스를 나타내는 데이터가 없어서 PUT 요청이 성공적으로 하나를 새로 생성한 경우, 출처 서버는 반드시 사용자 에이전트에게 201 (Create) 응답을 보내 해당 사항을 알려야함
    - 대상 리소스를 나타내는 데이터가 있어서 성공적으로 수정했다면, 출처 서버는 반드시 200 (OK) 또는 204 (No Content) 응답을 보내 성공을 알려야함
    - 문법: PUT /new.html HTTP/1.1
- TRACE: 대상 리소스에 대한 경로를 따라 메시지 루프백 테스트를 수행해서 디버깅 메커니즘을 제공하는 메서드
    - 문법: TRACE /index.html

HTTP와 TCP/IP
- 클라이언트와 서버가 HTTP를 요청/응답으로 교환하기 전에, 여러 왕복이 필요한 프로세스인 TCP 연결을 설정해야 한다

### 3. HTTP 상태 코드


| 코드 | 메시지 | 설명 |
| -------- | -------- | -------- |
| 1XX     | Intofmration(정보)     | 정보교환     |
| 2XX     | Success(성공)     | 데이터 전송이 성공적으로 이루어졌거나, 이해되었거나, 수락되었음     |
| 200     | OK     | 오류 없이 전송 성공     |
| 202     | Accepted     | 서버가 클라이언트의 요청을 수락함     |
| 204     | Non Content     | 클라이언트의 요구를 처리했으나, 전송할 데이터가 없음     |
| 3XX     | Redirection(방향 바꿈)     | 자료의 위치가 바뀌었음     |
| 4XX     | Client Error(클라이언트 오류)     | 클라이언트 측의 오류. 주소를 잘못 입력하였거나 요청이 잘못 되었음     |
| 400     | Bad Request     | 요청 실패. 문법상 오류가 있어서 서버가 요청사항을 이해하지 못함     |
| 401     | Unauthorized     | 권한 없음     |
| 403     | Forbidden     | 금지     |
| 404     | Not Found     | 문서를 찾을 수 없음. 서버가 요청한 파일이나 스크립트를 찾지 못함     |
| 5XX     | Server Error(서버 오류)     | 서버 측의 오류로 올바른 요청을 처리할 수 없음     |
| 500     | Internal Server Error     | 서버 내부 오류     |
| 502     | Bad gateway     | 게이트웨이 상태 나쁨 (서버의 과부하 상태Gateway나 proxy로 활동하고 있는 서버가 요구 사항을 접수한 upstream 서버로부터 불명확한 답변을 접수 했을 때 발생)     |
| 503     | Service Unavailable     | 외부 서비스가 죽었거나 현재 멈춘 상태 또는 이용할 수 없는 서비스     |



## 📝 TCP/IP
![](https://i.imgur.com/T94nK6a.jpg)

현재 수많은 프로그램들이 인터넷으로 통신하는 데 있어 가장 기반이 되는 프로토콜이며, 실제 대다수 프로그램은 TCP와 IP로 통신 (네트워킹) 하고 있다

### 1. TCP

- TCP(Transmission Control Protocol): 컴퓨터가 다른 컴퓨터와 데이터 통신을 하기 위한 프로토콜 (전송 제어 프로토콜)
- OSI 모형에서 4번째 계층인 전송 계층 (Transport Layer)에서 사용하는 규약으로, 하위 계층에서 사용하는 IP와 엮어서 TCP/IP로 많이 표현함
- 동일 계층에서 사용하는 또 다른 프로토콜로 UDP가 있다

#### 1) 연결설정

Three Way Handshake
- 1) 상대에게 통신을 하고 싶다는 메시지를 보낸다
- 2) 상대는 그 메시지에 대한 응답 + 나도 통신 준비가 되었다는 메시지를 보낸다
- 3) 2번에서 받은 메시지에 응답을 보낸다

#### 2) 신뢰성 보장과 흐름 제어(Flow Control)

- 연결설정을 통해 통신 준비 마치면 서로 데이터 주고 받을 수 있다
- 네트워크를 통해 한번에 보낼 수 있는 데이터 양은 제한되어 있어서 분할해서 보내야한다 (분할되는 데이터에는 고유번호가 부여된다)
- 데이터를 무턱대고 많이 보낼 수 있는 것은 아니고, 받아야 하는 데이터와, 받을 수 있는 양을 알려주면 거기에 맞춰서 알아서 보내준다
- TCP의 헤더파일을 보면 목적지주소, 확인 응답, 오류 검출 및 복원, 실제 데이터 등이 포함되는데, UDP와 구분되는 것이 확인응답 파일이다
    - 계속 확인응답을 보내어 잘 갔는지, 잘 왔는지 확인하기 때문에 데이터 신뢰도가 높다
    - 데이터 용량이 증가해서 수신속도가 떨어진다는 단점이 있지만, 신뢰성이 높다는 장점이 훨씬 크다


#### 3) 혼잡 제어 (Congestion Control)

네트워크 회선이 부하를 감당하지 못하고 네트워크 기기에 무한히 몰리게 되는 상황 발생
(중간 네트워크 기기가 송신하는 속도가, 그 기기가 수신하는 속도보다 느리게 되면 발생: burst)

송신자 A: 보냈는데 잘 갔는지 연락이 안와서 다시 보냄
송신자 B: 보냈는데 잘 갔는지 연락이 안와서 다시 보냄
송신자 C: 보냈는데 잘 갔는지 연락이 안와서 다시 보냄

-> 문제점1 : 라우터의 저장 한계 용량이 있는데, 저장되지 못한 데이터들은 손실된다
-> 문제점2 : 버려지는 패킷을 위해 전력을 낭비한다

AIMD (Addictive Increase/Multicative Decrease)
- 일단 보내는 쪽에서 조금씩 보내보고, 상대가 잘 받았으면 이후 보내는 양을 조금씩 늘린다. 그러다가 상대가 데이터를 제대로 받지 못한 것이 확인되면 그 즉시 보내는 양을 확 줄인다. 그리고 다시 슬슬 보내는 양을 늘렸다가 또 못받았으면 줄여버리는 형태로 보내는 양을 조절한다.
- 버스트 (burst)를 줄이기 위한 것

TCP가 오히려 비효율적인 경우도 발생하는데(실시간성을 중요시하거나 응답성을 중요시하는 프로그램), 이를 위해 개발된 것이 UDP이다

### 2. IP

- IP(Internet Protocol): 인터넷이 통하는 네트워크에서 어떤 정보를 수신하고 송신하는 통신에 대한 규약을 의미
- 컴퓨터의 경우 사용하는 운영체제도 다르고, 프로그램의 경우 아예 구현된 언어가 다르기 때문에 네트워크에서 이들이 통신할 수 있도록 하려면 공통된 통신 규약이 필요하다
- OSI 7계층에서 Layer3(Network Layer)와 Internet Protocol Suite의 Layer3(Internet Layer)에 위치하는 프로토콜
- 호스트에서 호스트까지의 통신 (보내는 컴퓨터에서 받는 컴퓨터까지의 통신)을 책임진다
    - 편지봉투에 보내는 주소, 받는 주소를 작성하고 우표를 붙여서 우체통에 넣는 일과, 우편함에 들어온 편지를 꺼내서 나한테 온 편지가 맞는지 확인하는 정도의 작업

#### 1) IPv4

- 널리 사용되는 IP주소로, 32비트의 값을 가진다
- 보통 8비트씩 끊어 0~255의 10진수 숫자로 나타내며, 각 숫자는 점으로 구분한다
- 32비트의 정보를 가지므로 최대 43억개의 고유한 주소를 부여할 수 있다
- 2011년 2월 4일부터 IPv4의 할당 중지를 선언했다 (더이상 줄 IPv4가 없다는 의미)
- 기존에 할당된 IPv4는 계속 유지 및 관리되며, IPv6으로 완전히 전환되고 나면 IPv4 서비스도 종료될 예정이지만 언제일지는 모름

#### 2) IPv6

- 128비트의 값을 가진다
- 일반적으로 4자리의 16진수 숫자 8개로 표기하고, 각각 쌍점:으로 구분한다
- IPv4 주소의 고갈을 앞두고 차기 주소 체계로서 고안되었다

---
참고자료
- https://ko.wikipedia.org/wiki/HTTP
- https://developer.mozilla.org/en-US/docs/Web/HTTP
- https://namu.wiki/w/TCP/IP
