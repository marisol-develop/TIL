## ğŸ§ Notification?!

![](https://velog.velcdn.com/images/marisol/post/c968c9f6-f6ac-45be-bca8-60333b2a21bd/image.png)

ì •ì˜ë¥¼ ë³´ë©´ 
`Notificationì€ ë“±ë¡ëœ ê´€ì°°ìì—ê²Œ ì •ë³´ë¥¼ ë¸Œë¡œë“œìºìŠ¤íŠ¸í•  ìˆ˜ ìˆëŠ” ì•Œë¦¼ ë°œì†¡ ë©”ì»¤ë‹ˆì¦˜ì´ë‹¤` ë¼ê³  ë˜ì–´ ìˆëŠ”ë°, 

ì—¬ê¸°ì„œ í¬ì¸íŠ¸ëŠ”
> - ë“±ë¡ëœ ê´€ì°°ìì—ê²Œ (addObserver)
- ì •ë³´ë¥¼ ë¸Œë¡œë“œìºìŠ¤íŠ¸ (post)

í•œë‹¤ëŠ” ê²ƒì´ë‹¤.

ì–´ë–¤ ì´ë²¤íŠ¸ì— ëŒ€í•œ ì•Œë¦¼ì„ ë°›ê¸°ë¥¼ ì›í•˜ëŠ” ê´€ì°°ìë¥¼ ì¶”ê°€í•˜ë©´,
ê·¸ ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ë©´ ì•Œë ¤ì£¼ëŠ” ë©”ì»¤ë‹ˆì¦˜ ì´ë¼ëŠ” ê²ƒ ê°™ë‹¤.

ê³„ì† ê³µì‹ë¬¸ì„œë¥¼ ì½ì–´ë³´ë©´, 

> `addObserver()` ë©”ì„œë“œë¥¼ í†µí•´ ê°ì²´ë¥¼ ì•Œë¦¼ì„¼í„°ì— ê´€ì°°ìë¡œ ë“±ë¡í•  ìˆ˜ ìˆë‹¤.
ê°ì²´ê°€ ê´€ì°°ìë¡œ ìì‹ ì„ ì¶”ê°€í•  ë•Œ, ìˆ˜ì‹ í•´ì•¼ í•  ì•Œë¦¼ì„ ì§€ì •í•œë‹¤.
ê°ì²´ëŠ” ì—¬ëŸ¬ ë‹¤ë¥¸ ì•Œë¦¼ì— ëŒ€í•œ ê´€ì°°ìë¡œ ë“±ë¡í•˜ê¸° ìœ„í•´, `addObserver()` ë©”ì„œë“œë¥¼ ì—¬ëŸ¬ë²ˆ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤.
ì‹¤í–‰ ì¤‘ì¸ ê° ì•±ì—ëŠ” ê¸°ë³¸ ì•Œë¦¼ ì„¼í„°ê°€ ìˆìœ¼ë©°, ìƒˆ ì•Œë¦¼ ì„¼í„°ë¥¼ ë§Œë“¤ ìˆ˜ë„ ìˆë‹¤.

ê·¸ëŸ¬ë‹ˆê¹Œ í•œ ê°ì²´ê°€ ì—¬ëŸ¬ ì•Œë¦¼ì„ ë°›ì„ ìˆ˜ë„ ìˆëŠ” ë“¯ í•˜ë‹¤!

## ğŸ’» í‚¤ë³´ë“œê°€ í…ìŠ¤íŠ¸ë·°ë¥¼ ê°€ë¦¬ì§€ ì•Šë„ë¡ í•˜ê¸°

í‚¤ë³´ë“œê°€ í…ìŠ¤íŠ¸ë·°ë¥¼ ê°€ë¦¬ì§€ ì•Šë„ë¡ í•˜ëŠ” ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ê¸° ìœ„í•´ ë¨¼ì € ì•„ë˜ì™€ ê°™ì´ ê°€ì´ë“œë¼ì¸ì„ ì¡ì•˜ë‹¤.

1ï¸âƒ£ Observerë¥¼ ì¶”ê°€í•´ì¤€ë‹¤
- í…ìŠ¤íŠ¸ë·°ë¥¼ ê°€ì§„ ë·°

2ï¸âƒ£ ì–´ë–¤ ì´ë²¤íŠ¸ê°€ ë°œìƒí–ˆì„ ë•Œ ê·¸ Observerì—ê²Œ ì•Œë¦¼ì„ ë°œì†¡í•œë‹¤
- í…ìŠ¤íŠ¸ë·°ë¥¼ í„°ì¹˜í–ˆì„ ë•Œ í‚¤ë³´ë“œê°€ ì˜¬ë¼ì˜¤ëŠ” ê²ƒ
- í…ìŠ¤íŠ¸ë·° ì´ì™¸ì˜ í™”ë©´ì„ í„°ì¹˜í–ˆì„ ë•Œ í‚¤ë³´ë“œê°€ ë‚´ë ¤ê°€ëŠ” ê²ƒ

3ï¸âƒ£ ì•Œë¦¼ì„ ë°›ìœ¼ë©´ í…ìŠ¤íŠ¸ë·°ë¥¼ í‚¤ë³´ë“œ ë†’ì´ë§Œí¼ ì¤„ì´ê±°ë‚˜, ì›ë˜ í¬ê¸°ë¡œ ëŠ˜ì´ê¸°

NotificationCenterì˜ íƒ€ì…í”„ë¡œí¼í‹°ë¡œ defaultê°€ ìˆëŠ”ë°, ê³µì‹ë¬¸ì„œì—ì„œ ë§í–ˆë˜ ê¸°ë³¸ ì•Œë¦¼ì„¼í„°ì¸ê²ƒ ê°™ë‹¤.
ì´ê±¸ ì¨ì„œ ê¸°ë³¸ ì•Œë¦¼ì„¼í„°ì— Observerë¥¼ ì¶”ê°€í•´ì¤€ë‹¤.

```swift
private func addKeyboardObserver() {
  NotificationCenter.default.addObserver(self, 
                         selector: #selector(keyboardWillShow), 
                                           name: UIResponder.keyboardWillShowNotification, 
                                           object: nil)
  NotificationCenter.default.addObserver(self, 
                         selector: #selector(keyboardWillHide), 
                                           name: UIResponder.keyboardWillHideNotification, 
                                           object: nil)
}
```

`addObserver` ë©”ì„œë“œì—ëŠ” íŒŒë¼ë¯¸í„°ê°€ 4ê°œë‚˜ ìˆëŠ”ë°, í•˜ë‚˜ì”© ì‚´í´ë³´ìë©´
- observer: Observerë¡œ ë“±ë¡í•  ê°ì²´
- selector: ì•Œë¦¼ì„ ë°›ìœ¼ë©´ Observerê°€ ìˆ˜í–‰í•˜ëŠ” ë©”ì„œë“œ
- name: Observerì—ê²Œ ì „ë‹¬í•˜ê¸° ìœ„í•´ ë“±ë¡í•  ì•Œë¦¼ì˜ ì´ë¦„
  - Notification.Nameì˜ íƒ€ì…í”„ë¡œí¼í‹°ë¡œ keyboardWillShowNotification(í‚¤ë³´ë“œê°€ í‘œì‹œë˜ê¸° ì§ì „ì— postë¨)ì™€ keyboardWillHideNotification(í‚¤ë³´ë“œê°€ ì‚¬ë¼ì§€ê¸° ì§ì „ì— postë¨)ê°€ ìˆì–´ì„œ ê·¸ê±¸ ì‚¬ìš©í–ˆë‹¤.
- object: Observerì—ê²Œ ë³´ë‚´ëŠ” ê°ì²´

ìš”ë ‡ê²Œ ëœë‹¤.

í…ìŠ¤íŠ¸ë·°ë¥¼ í´ë¦­í•˜ë©´ í‚¤ë³´ë“œê°€ ì˜¬ë¼ì˜¤ëŠ”ë°, 
í‚¤ë³´ë“œê°€ ì˜¬ë¼ì˜¤ê¸° ì§ì „ì— keyboardWillShowNotificationì´ë¼ëŠ” ì´ë¦„ì˜ Notificationì´ postë˜ê³ 
ê·¸ëŸ¬ë©´ Observerë¡œ ë“±ë¡í•œ ë·°ê°€ ê·¸ Notificationì„ ë°›ì•„ì„œ #selectorì˜ ë©”ì„œë“œë¥¼ ì‹¤í–‰í•˜ëŠ” í”„ë¡œì„¸ìŠ¤ì¸ ê²ƒ ê°™ë‹¤.

ê·¸ëŸ¼ ì•Œë¦¼ì„ ë°›ì•˜ì„ ë•Œ ì‹¤í–‰í•˜ëŠ” keyboardWillShowì™€ keyboardWillHideì—ì„œëŠ” ì–´ë–¤ì¼ì´ ë²Œì–´ì§ˆê¹Œ?!

keyboardWillShowì—ì„œëŠ”
1) userInfo (Notificationê³¼ ê´€ë ¨ëœ ê°’(keyboard)ì˜ ì •ë³´ê°€ ë“¤ì–´ìˆëŠ” ë”•ì…”ë„ˆë¦¬ í˜•íƒœì˜ ì €ì¥ì†Œ)ë¥¼ ì‚¬ìš©í•´ì„œ í‚¤ë³´ë“œì˜ ë†’ì´ë¥¼ êµ¬í•¨
2) textViewì˜ heightë¥¼ í‚¤ë³´ë“œì˜ ë†’ì´ë§Œí¼ ì¤„ì„

keyboardWillHideì—ì„œëŠ”
1) ë‹¤ì‹œ textViewì˜ heightë¥¼ ì›ë˜ëŒ€ë¡œ ëŠ˜ì„

ì´ë ‡ê²Œ êµ¬í˜„í•´ë³´ì•˜ë‹¤.

```swift
@objc private func keyboardWillShow(_ notification: Notification) {
  guard let userInfo = notification.userInfo,
        let keyboardFrame = userInfo[UIResponder.keyboardFrameEndUserInfoKey] as? CGRect else {
            return
    }
    
    let contentInset = UIEdgeInsets(top: 0.0, left: 0.0, bottom: keyboardFrame.height, right: 0.0)
    diaryTextView.contentInset = contentInset
    diaryTextView.scrollIndicatorInsets = contentInset
}

@objc private func keyboardWillHide() {
  let contentInset = UIEdgeInsets.zero
    diaryTextView.contentInset = contentInset
    diaryTextView.scrollIndicatorInsets = contentInset
}
```

ì—¬ê¸°ì„œ í‚¤ë³´ë“œì˜ í”„ë ˆì„ì„ êµ¬í•  ë•Œ ì‚¬ìš©ë˜ëŠ” keyboardFrameEndUserInfoKeyëŠ” 
> "A user info key to retrieve the keyboardâ€™s frame at the end of its animation."

ì• ë‹ˆë©”ì´ì…˜ ë§ˆì§€ë§‰ì— í‚¤ë³´ë“œì˜ í”„ë ˆì„ì„ ë°˜í™˜í•˜ëŠ” user info keyë¼ê³  í•œë‹¤.
ê·¸ë˜ì„œ ì´ê±¸ keyë¡œ userInfoì—ì„œ í‚¤ë³´ë“œì˜ í”„ë ˆì„ì„ êµ¬í•˜ëŠ” ê²ƒ ê°™ë‹¤!

## ğŸ’» ì•±ì´ ë°±ê·¸ë¼ìš´ë“œì— ì§„ì…í–ˆì„ë•Œ ë°ì´í„° ì €ì¥í•˜ê¸°

1ï¸âƒ£ Observerë¥¼ ì¶”ê°€í•´ì¤€ë‹¤
- CoreDataì— ë³€ê²½ì‚¬í•­ì„ ì €ì¥í•˜ëŠ” ë©”ì„œë“œë¥¼ ê°€ì§„ ViewController

2ï¸âƒ£ ì–´ë–¤ ì´ë²¤íŠ¸ê°€ ë°œìƒí–ˆì„ ë•Œ ê·¸ Observerì—ê²Œ ì•Œë¦¼ì„ ë°œì†¡í•œë‹¤
- ì•±ì´ ë°±ê·¸ë¼ìš´ë“œì— ì§„ì…í–ˆì„ë•Œ

í‚¤ë³´ë“œ í–ˆì„ ë•Œë‘ ë˜‘ê°™ì´ addObserverë¥¼ í•´ì¤€ë‹¤.

```swift
NotificationCenter.default.addObserver(self, 
                     selector: #selector(saveDiary),
                                       name: Notification.Name.sceneDidEnterBackgroundNotification,
                                       object: nil)
```

(sceneDidEnterBackgroundNotificationì€ Notification.Nameì„ extensioní•´ì„œ ë§Œë“¤ì–´ì¤¬ë‹¤)

ê·¸ë¦¬ê³  ì•Œë¦¼ì„ ë°œì†¡í•˜ëŠ” ì‹œì  == ì•±ì´ ë°±ê·¸ë¼ìš´ë“œì— ì§„ì…í•˜ëŠ” ì‹œì ì´ê¸° ë•Œë¬¸ì—
SceneDelegateì˜ `sceneDidEnterBackground(_ scene: UIScene)` ë©”ì„œë“œì—ì„œ postë¥¼ í•´ì¤€ë‹¤.

```swift
NotificationCenter.default.post(name: Notification.Name.sceneDidEnterBackgroundNotification,
                object: nil)
```

ì´ëŸ¬ë©´ observerì—ì„œ ì•Œë¦¼ì„ ìˆ˜ì‹ í–ˆì„ë•Œ #selectorì˜ saveDiaryë¥¼ ì‹¤í–‰í•´ì„œ ë°ì´í„°ë¥¼ ì €ì¥í•  ìˆ˜ ìˆë‹¤!ğŸ˜

---
ì°¸ê³ ìë£Œ
- https://developer.apple.com/documentation/foundation/notification
- https://developer.apple.com/documentation/foundation/notificationcenter/1415360-addobserver
- https://leeari95.tistory.com/49
